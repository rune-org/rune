// ⚠️ GENERATED FILE - DO NOT EDIT MANUALLY
// This file is generated from dsl/dsl-definition.json
// To update, modify dsl/dsl-definition.json and run: make dsl-generate

import type { Edge, Node } from "@xyflow/react";
import type { CredentialRef } from "@/lib/credentials";

/** The base data structure that all nodes share. */
export type BaseData = {
  label?: string;
  credential?: CredentialRef | null;
  /** When true, the node's position is preserved during auto-layout. */
  pinned?: boolean;
};

/** A map defining the specific data for each kind of node. */
export type NodeDataMap = {
{% for node_type, node_def in dsl.node_types.items() %}
  {{ node_def.frontend_type }}: BaseData{% if node_def.parameters %} & {
{% for param_name, param_def in node_def.parameters.items() %}
{% if param_name in node_def.get("frontend_parameter_mapping", {}) %}
    {{ node_def.frontend_parameter_mapping[param_name] }}?: {% if param_def.type == "string" or param_def.type == "string|array" %}string{% elif param_def.type == "number" %}number{% elif param_def.type == "boolean" %}boolean{% elif param_def.type == "object" %}Record<string, unknown>{% elif param_def.type == "array" %}unknown[]{% else %}unknown{% endif %};
{% else %}
    {{ param_name }}?: {% if param_def.type == "string" or param_def.type == "string|array" %}string{% elif param_def.type == "number" %}number{% elif param_def.type == "boolean" %}boolean{% elif param_def.type == "object" %}Record<string, unknown>{% elif param_def.type == "array" %}unknown[]{% else %}unknown{% endif %};
{% endif %}
{% endfor %}
  }{% endif %};
{% endfor %}
};

/** A union type of all possible node kinds. */
export type NodeKind = keyof NodeDataMap;

/** Node schema defining inputs and outputs for each node type. */
// TODO: Update inputs/outputs based on node type requirements from DSL
export const NODE_SCHEMA = {
{% for node_type, node_def in dsl.node_types.items() %}
  {{ node_def.frontend_type }}: {
    inputs: [], // TODO: Define based on node type
    outputs: [], // TODO: Define based on node type
  },
{% endfor %}
} as const satisfies Record<NodeKind, { inputs: readonly string[]; outputs: readonly string[] }>;

export type CanvasNode = {
  [K in NodeKind]: Node<NodeDataMap[K]> & { type: K };
}[NodeKind];

{% for node_type, node_def in dsl.node_types.items() %}
export type {{ node_def.frontend_type | capitalize }}Data = NodeDataMap["{{ node_def.frontend_type }}"];
{% endfor %}

export type CanvasEdge = Edge;

{% for node_type, node_def in dsl.node_types.items() %}
{% if node_type == "switch" %}
export type SwitchRule = {
  value?: string;
  operator?: SwitchOperator;
  compare?: string;
};

export type SwitchOperator =
  | "=="
  | "!="
  | ">"
  | "<"
  | ">="
  | "<="
  | "contains";
{% endif %}
{% endfor %}
